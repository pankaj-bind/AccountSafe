<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üö® Security Breach Alert - AccountSafe</title>
</head>
<body style="margin: 0; padding: 0; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica Neue', 'Arial', sans-serif; background-color: #f3f4f6; line-height: 1.5;">
    
    <!-- Email Container -->
    <table width="100%" cellpadding="0" cellspacing="0" style="background-color: #f3f4f6; padding: 40px 0;">
        <tr>
            <td align="center">
                <!-- Main Card -->
                <table width="100%" cellpadding="0" cellspacing="0" style="max-width: 600px; background-color: #ffffff; border: 1px solid #e5e7eb; overflow: hidden;">
                    
                    <!-- RED Accent Bar (Top) - Danger -->
                    <tr>
                        <td style="height: 4px; background-color: #dc2626;"></td>
                    </tr>
                    
                    <!-- Header with Logo -->
                    <tr>
                        <td style="background-color: #111827; padding: 20px 32px;">
                            <table width="100%" cellpadding="0" cellspacing="0">
                                <tr>
                                    <td style="vertical-align: middle;">
                                        <!-- Logo Container -->
                                        <table cellpadding="0" cellspacing="0" style="display: inline-block;">
                                            <tr>
                                                <td style="background: linear-gradient(135deg, #fef2f2 0%, #fecaca 100%); padding: 8px; border-radius: 8px; border: 1px solid rgba(220, 38, 38, 0.2);">
                                                    <img src="https://accountsafe.vercel.app/logo.png" alt="AccountSafe" width="24" height="24" style="display: block; border: 0;" />
                                                </td>
                                                <td style="padding-left: 12px; vertical-align: middle;">
                                                    <span style="color: #ffffff; font-size: 18px; font-weight: 700; letter-spacing: -0.3px;">AccountSafe</span>
                                                </td>
                                            </tr>
                                        </table>
                                    </td>
                                    <td style="text-align: right;">
                                        <span style="background-color: #dc2626; color: white; padding: 4px 12px; border-radius: 9999px; font-size: 11px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em;">BREACH ALERT</span>
                                    </td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                    
                    <!-- Main Content -->
                    <tr>
                        <td style="padding: 40px 32px 32px;">
                            
                            <!-- Alert Icon and Headline -->
                            <div style="text-align: center; margin-bottom: 28px;">
                                <div style="display: inline-block; background-color: #fef2f2; border-radius: 50%; padding: 16px; margin-bottom: 16px;">
                                    <!-- Warning Icon -->
                                    <svg width="40" height="40" viewBox="0 0 24 24" fill="none" style="display: block;">
                                        <path d="M12 9V13M12 17H12.01M10.29 3.86L1.82 18A2 2 0 003.54 21H20.46A2 2 0 0022.18 18L13.71 3.86A2 2 0 0010.29 3.86Z" stroke="#dc2626" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                    </svg>
                                </div>
                                <h1 style="margin: 0 0 8px; color: #dc2626; font-size: 24px; font-weight: 700; letter-spacing: -0.5px; line-height: 1.3;">
                                    Canary Trap Triggered!
                                </h1>
                                <p style="margin: 0; color: #6b7280; font-size: 14px;">
                                    Your security trap credential was accessed
                                </p>
                            </div>
                            
                            <!-- Trap Info Card -->
                            <div style="background-color: #fef2f2; border: 1px solid #fecaca; border-radius: 12px; padding: 20px; margin-bottom: 24px;">
                                <table width="100%" cellpadding="0" cellspacing="0">
                                    <tr>
                                        <td style="vertical-align: top; padding-right: 16px;">
                                            <!-- Trap Icon -->
                                            <div style="background-color: #dc2626; border-radius: 8px; width: 40px; height: 40px; display: flex; align-items: center; justify-content: center;">
                                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" style="display: block; margin: auto;">
                                                    <path d="M12 22S4 18 4 11V5L12 2L20 5V11C20 18 12 22 12 22Z" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                                </svg>
                                            </div>
                                        </td>
                                        <td style="vertical-align: top;">
                                            <div style="color: #dc2626; font-size: 11px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; margin-bottom: 4px;">TRAP TRIGGERED</div>
                                            <div style="color: #111827; font-size: 18px; font-weight: 700;">{{ trap_label }}</div>
                                            <div style="color: #6b7280; font-size: 13px; margin-top: 4px;">{{ trap_type }} ‚Ä¢ Triggered {{ triggered_count }} time{% if triggered_count != 1 %}s{% endif %}</div>
                                        </td>
                                    </tr>
                                </table>
                            </div>
                            
                            <!-- What This Means -->
                            <div style="background-color: #fffbeb; border-left: 3px solid #f59e0b; padding: 16px 18px; margin-bottom: 24px; border-radius: 4px;">
                                <table cellpadding="0" cellspacing="0">
                                    <tr>
                                        <td style="vertical-align: top; padding-right: 10px;">
                                            <svg width="18" height="18" viewBox="0 0 20 20" fill="none" style="display: block; margin-top: 1px;">
                                                <path d="M10 18C14.4183 18 18 14.4183 18 10C18 5.58172 14.4183 2 10 2C5.58172 2 2 5.58172 2 10C2 14.4183 5.58172 18 10 18Z" stroke="#f59e0b" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                                                <path d="M10 14V10" stroke="#f59e0b" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                                                <path d="M10 6H10.01" stroke="#f59e0b" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                            </svg>
                                        </td>
                                        <td style="vertical-align: top;">
                                            <div style="color: #92400e; font-size: 13px; font-weight: 600; margin-bottom: 4px;">What does this mean?</div>
                                            <div style="color: #78350f; font-size: 13px; line-height: 1.5;">
                                                Someone accessed a trap credential you planted. This is a strong indicator that your credentials may have been stolen or your vault has been compromised.
                                            </div>
                                        </td>
                                    </tr>
                                </table>
                            </div>
                            
                            <!-- Access Details Card -->
                            <table width="100%" cellpadding="0" cellspacing="0" style="border: 1px solid #e5e7eb; border-radius: 8px; background-color: #ffffff; margin-bottom: 28px; overflow: hidden;">
                                <tr>
                                    <td colspan="2" style="background-color: #f9fafb; padding: 12px 20px; border-bottom: 1px solid #e5e7eb;">
                                        <div style="color: #374151; font-size: 13px; font-weight: 600;">Access Details</div>
                                    </td>
                                </tr>
                                
                                <!-- 2-Column Grid Row 1: IP Address | Time -->
                                <tr>
                                    <!-- IP Address -->
                                    <td width="50%" style="padding: 18px 20px; border-bottom: 1px solid #e5e7eb; border-right: 1px solid #e5e7eb; vertical-align: top;">
                                        <table cellpadding="0" cellspacing="0">
                                            <tr>
                                                <td style="vertical-align: top; padding-right: 8px;">
                                                    <svg width="14" height="14" viewBox="0 0 20 20" fill="none" style="display: block; margin-top: 2px;">
                                                        <path d="M10 18C14.4183 18 18 14.4183 18 10C18 5.58172 14.4183 2 10 2C5.58172 2 2 5.58172 2 10C2 14.4183 5.58172 18 10 18Z" stroke="#9ca3af" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                                                        <path d="M2 10H18" stroke="#9ca3af" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                                                        <path d="M10 2C12.5013 4.73835 13.9228 8.29203 14 12C13.9228 15.708 12.5013 19.2616 10 22C7.49872 19.2616 6.07725 15.708 6 12C6.07725 8.29203 7.49872 4.73835 10 2Z" stroke="#9ca3af" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                                                    </svg>
                                                </td>
                                                <td style="vertical-align: top;">
                                                    <div style="color: #6b7280; font-size: 11px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; margin-bottom: 4px;">IP Address</div>
                                                    <div style="color: #111827; font-size: 14px; font-family: 'SF Mono', Monaco, 'Courier New', monospace; font-weight: 500;">{{ ip_address }}</div>
                                                </td>
                                            </tr>
                                        </table>
                                    </td>
                                    
                                    <!-- Time -->
                                    <td width="50%" style="padding: 18px 20px; border-bottom: 1px solid #e5e7eb; vertical-align: top;">
                                        <table cellpadding="0" cellspacing="0">
                                            <tr>
                                                <td style="vertical-align: top; padding-right: 8px;">
                                                    <svg width="14" height="14" viewBox="0 0 20 20" fill="none" style="display: block; margin-top: 2px;">
                                                        <path d="M10 18C14.4183 18 18 14.4183 18 10C18 5.58172 14.4183 2 10 2C5.58172 2 2 5.58172 2 10C2 14.4183 5.58172 18 10 18Z" stroke="#9ca3af" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                                                        <path d="M10 6V10L13 13" stroke="#9ca3af" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                                                    </svg>
                                                </td>
                                                <td style="vertical-align: top;">
                                                    <div style="color: #6b7280; font-size: 11px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; margin-bottom: 4px;">Time</div>
                                                    <div style="color: #111827; font-size: 14px; font-weight: 500;">{{ timestamp }}</div>
                                                </td>
                                            </tr>
                                        </table>
                                    </td>
                                </tr>
                                
                                <!-- 2-Column Grid Row 2: Device | Location -->
                                <tr>
                                    <!-- Device -->
                                    <td width="50%" style="padding: 18px 20px; border-right: 1px solid #e5e7eb; vertical-align: top;">
                                        <table cellpadding="0" cellspacing="0">
                                            <tr>
                                                <td style="vertical-align: top; padding-right: 8px;">
                                                    <span style="font-size: 14px; display: block; margin-top: 2px;">{{ device.device_icon }}</span>
                                                </td>
                                                <td style="vertical-align: top;">
                                                    <div style="color: #6b7280; font-size: 11px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; margin-bottom: 4px;">Device</div>
                                                    <div style="color: #111827; font-size: 14px; font-weight: 500;">{{ device.device_name }}</div>
                                                    {% if device.browser and device.os %}
                                                    <div style="color: #6b7280; font-size: 12px; margin-top: 2px;">{{ device.browser }} ‚Ä¢ {{ device.os }}</div>
                                                    {% endif %}
                                                </td>
                                            </tr>
                                        </table>
                                    </td>
                                    
                                    <!-- Location -->
                                    <td width="50%" style="padding: 18px 20px; vertical-align: top;">
                                        <table cellpadding="0" cellspacing="0">
                                            <tr>
                                                <td style="vertical-align: top; padding-right: 8px;">
                                                    <svg width="14" height="14" viewBox="0 0 20 20" fill="none" style="display: block; margin-top: 2px;">
                                                        <path d="M17.5 8.33333C17.5 14.1667 10 19.1667 10 19.1667C10 19.1667 2.5 14.1667 2.5 8.33333C2.5 6.34421 3.29018 4.4366 4.6967 3.03007C6.10322 1.62355 8.01088 0.833328 10 0.833328C11.9891 0.833328 13.8968 1.62355 15.3033 3.03007C16.7098 4.4366 17.5 6.34421 17.5 8.33333Z" stroke="#9ca3af" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                                                        <path d="M10 10.8333C11.3807 10.8333 12.5 9.71405 12.5 8.33333C12.5 6.95262 11.3807 5.83333 10 5.83333C8.61929 5.83333 7.5 6.95262 7.5 8.33333C7.5 9.71405 8.61929 10.8333 10 10.8333Z" stroke="#9ca3af" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                                                    </svg>
                                                </td>
                                                <td style="vertical-align: top;">
                                                    <div style="color: #6b7280; font-size: 11px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; margin-bottom: 4px;">Location</div>
                                                    <div style="color: #111827; font-size: 14px; font-weight: 500;">{% if location %}{{ location }}{% else %}Unknown{% endif %}</div>
                                                    {% if isp %}
                                                    <div style="color: #6b7280; font-size: 12px; margin-top: 2px;">{{ isp }}</div>
                                                    {% endif %}
                                                </td>
                                            </tr>
                                        </table>
                                    </td>
                                </tr>
                                
                                {% if referer %}
                                <!-- Referer Row -->
                                <tr>
                                    <td colspan="2" style="padding: 18px 20px; border-top: 1px solid #e5e7eb; vertical-align: top;">
                                        <div style="color: #6b7280; font-size: 11px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; margin-bottom: 4px;">Referer</div>
                                        <div style="color: #111827; font-size: 13px; font-family: 'SF Mono', Monaco, 'Courier New', monospace; word-break: break-all;">{{ referer }}</div>
                                    </td>
                                </tr>
                                {% endif %}
                            </table>
                            
                            <!-- Recommended Actions -->
                            <div style="background-color: #fef2f2; border: 1px solid #fecaca; border-radius: 8px; padding: 20px; margin-bottom: 24px;">
                                <div style="color: #991b1b; font-size: 13px; font-weight: 700; margin-bottom: 12px;">üõ°Ô∏è RECOMMENDED ACTIONS</div>
                                <ol style="margin: 0; padding-left: 20px; color: #7f1d1d; font-size: 13px; line-height: 1.8;">
                                    <li><strong>Change all passwords</strong> in your vault immediately</li>
                                    <li><strong>Check for unauthorized access</strong> to your accounts</li>
                                    <li><strong>Enable 2FA</strong> on all critical accounts</li>
                                    <li><strong>Review the IP address</strong> for suspicious activity</li>
                                    <li><strong>Consider your vault password</strong> may be compromised</li>
                                </ol>
                            </div>
                            
                            <!-- CTA Button -->
                            <table width="100%" cellpadding="0" cellspacing="0" style="margin-bottom: 24px;">
                                <tr>
                                    <td align="center">
                                        <a href="https://accountsafe.vercel.app/security" style="display: inline-block; background-color: #dc2626; color: #ffffff; text-decoration: none; padding: 14px 32px; border-radius: 8px; font-size: 14px; font-weight: 600;">
                                            Review Security Settings
                                        </a>
                                    </td>
                                </tr>
                            </table>
                            
                        </td>
                    </tr>
                    
                    <!-- Footer -->
                    <tr>
                        <td style="background-color: #f9fafb; padding: 24px 32px; border-top: 1px solid #e5e7eb;">
                            <p style="margin: 0 0 12px; color: #6b7280; font-size: 12px; line-height: 1.6;">
                                This alert was triggered because someone accessed your canary trap credential. Canary traps are designed to detect when your credentials have been stolen.
                            </p>
                            <p style="margin: 0; color: #9ca3af; font-size: 11px;">
                                AccountSafe ‚Ä¢ Zero-Knowledge Security<br>
                                <a href="https://accountsafe.vercel.app" style="color: #6b7280; text-decoration: underline;">accountsafe.vercel.app</a>
                            </p>
                        </td>
                    </tr>
                    
                </table>
            </td>
        </tr>
    </table>
    
</body>
</html>
