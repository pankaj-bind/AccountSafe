<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% if alert.type == 'duress' %}Security Alert{% else %}New sign-in{% endif %} - AccountSafe</title>
</head>
<body style="margin: 0; padding: 0; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica Neue', 'Arial', sans-serif; background-color: #f3f4f6; line-height: 1.5;">
    
    <!-- Email Container -->
    <table width="100%" cellpadding="0" cellspacing="0" style="background-color: #f3f4f6; padding: 40px 0;">
        <tr>
            <td align="center">
                <!-- Main Card -->
                <table width="100%" cellpadding="0" cellspacing="0" style="max-width: 600px; background-color: #ffffff; border: 1px solid #e5e7eb; overflow: hidden;">
                    
                    <!-- Accent Bar (Top) -->
                    <tr>
                        <td style="height: 4px; background-color: {{ alert.accent_color }};"></td>
                    </tr>
                    
                    <!-- Header with Logo -->
                    <tr>
                        <td style="background-color: #111827; padding: 20px 32px;">
                            <table width="100%" cellpadding="0" cellspacing="0">
                                <tr>
                                    <td style="vertical-align: middle;">
                                        <!-- Logo Container -->
                                        <table cellpadding="0" cellspacing="0" style="display: inline-block;">
                                            <tr>
                                                <td style="background: linear-gradient(135deg, #ecfdf5 0%, #a7f3d0 100%); padding: 8px; border-radius: 8px; border: 1px solid rgba(16, 185, 129, 0.2);">
                                                    <img src="https://accountsafe.vercel.app/logo.png" alt="AccountSafe" width="24" height="24" style="display: block; border: 0;" />
                                                </td>
                                                <td style="padding-left: 12px; vertical-align: middle;">
                                                    <span style="color: #ffffff; font-size: 18px; font-weight: 700; letter-spacing: -0.3px;">AccountSafe</span>
                                                </td>
                                            </tr>
                                        </table>
                                    </td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                    
                    <!-- Main Content -->
                    <tr>
                        <td style="padding: 40px 32px 32px;">
                            
                            <!-- Headline -->
                            <h1 style="margin: 0 0 8px; color: #111827; font-size: 26px; font-weight: 700; letter-spacing: -0.5px; line-height: 1.3;">
                                {% if alert.type == 'duress' %}
                                Security Alert: Duress login detected
                                {% else %}
                                New sign-in from {{ device.browser }} on {{ device.os }}
                                {% endif %}
                            </h1>
                            
                            <!-- Timestamp -->
                            <p style="margin: 0 0 28px; color: #6b7280; font-size: 14px;">
                                {{ timestamp }}
                            </p>
                            
            <!-- Greeting (Only for Non-Duress) -->
            {% if alert.type != 'duress' %}
            <p style="margin: 0 0 24px; color: #374151; font-size: 15px; line-height: 1.6;">
                Hi <strong style="color: #111827;">{{ username }}</strong>,
            </p>
            {% endif %}
            
            <!-- Alert Message -->
            <p style="margin: 0 0 28px; color: #374151; font-size: 15px; line-height: 1.6;">
                {% if alert.type == 'duress' %}
                <strong style="color: #dc2626;">URGENT:</strong> A login using the <strong style="color: #dc2626;">Duress Protocol</strong> was detected on your account. If this was not you, your account security may be compromised and you should contact authorities immediately.
                {% else %}
                A new sign-in to your AccountSafe vault was detected. If this was you, you can disregard this email. If you don't recognize this activity, secure your account immediately.
                {% endif %}
            </p>
            
            <!-- Data Card -->
                            <table width="100%" cellpadding="0" cellspacing="0" style="border: 1px solid #e5e7eb; border-radius: 8px; background-color: #ffffff; margin-bottom: 28px; overflow: hidden;">
                                
                                <!-- 2-Column Grid Row 1: IP Address | Time -->
                                <tr>
                                    <!-- IP Address -->
                                    <td width="50%" style="padding: 18px 20px; border-bottom: 1px solid #e5e7eb; border-right: 1px solid #e5e7eb; vertical-align: top;">
                                        <table cellpadding="0" cellspacing="0">
                                            <tr>
                                                <td style="vertical-align: top; padding-right: 8px;">
                                                    <!-- Globe Icon SVG -->
                                                    <svg width="14" height="14" viewBox="0 0 20 20" fill="none" style="display: block; margin-top: 2px;">
                                                        <path d="M10 18C14.4183 18 18 14.4183 18 10C18 5.58172 14.4183 2 10 2C5.58172 2 2 5.58172 2 10C2 14.4183 5.58172 18 10 18Z" stroke="#9ca3af" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                                                        <path d="M2 10H18" stroke="#9ca3af" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                                                        <path d="M10 2C12.5013 4.73835 13.9228 8.29203 14 12C13.9228 15.708 12.5013 19.2616 10 22C7.49872 19.2616 6.07725 15.708 6 12C6.07725 8.29203 7.49872 4.73835 10 2Z" stroke="#9ca3af" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                                                    </svg>
                                                </td>
                                                <td style="vertical-align: top;">
                                                    <div style="color: #6b7280; font-size: 11px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; margin-bottom: 4px;">IP Address</div>
                                                    <div style="color: #111827; font-size: 14px; font-family: 'SF Mono', Monaco, 'Courier New', monospace; font-weight: 500;">{{ ip_address }}</div>
                                                </td>
                                            </tr>
                                        </table>
                                    </td>
                                    
                                    <!-- Time -->
                                    <td width="50%" style="padding: 18px 20px; border-bottom: 1px solid #e5e7eb; vertical-align: top;">
                                        <table cellpadding="0" cellspacing="0">
                                            <tr>
                                                <td style="vertical-align: top; padding-right: 8px;">
                                                    <!-- Clock Icon SVG -->
                                                    <svg width="14" height="14" viewBox="0 0 20 20" fill="none" style="display: block; margin-top: 2px;">
                                                        <path d="M10 18C14.4183 18 18 14.4183 18 10C18 5.58172 14.4183 2 10 2C5.58172 2 2 5.58172 2 10C2 14.4183 5.58172 18 10 18Z" stroke="#9ca3af" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                                                        <path d="M10 6V10L13 13" stroke="#9ca3af" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                                                    </svg>
                                                </td>
                                                <td style="vertical-align: top;">
                                                    <div style="color: #6b7280; font-size: 11px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; margin-bottom: 4px;">Time</div>
                                                    <div style="color: #111827; font-size: 14px; font-weight: 500;">{{ timestamp }}</div>
                                                </td>
                                            </tr>
                                        </table>
                                    </td>
                                </tr>
                                
                                <!-- 2-Column Grid Row 2: Device | Location -->
                                <tr>
                                    <!-- Device -->
                                    <td width="50%" style="padding: 18px 20px; border-right: 1px solid #e5e7eb; vertical-align: top;">
                                        <table cellpadding="0" cellspacing="0">
                                            <tr>
                                                <td style="vertical-align: top; padding-right: 8px;">
                                                    <!-- Device Icon (using emoji) -->
                                                    <span style="font-size: 14px; display: block; margin-top: 2px;">{{ device.device_icon }}</span>
                                                </td>
                                                <td style="vertical-align: top;">
                                                    <div style="color: #6b7280; font-size: 11px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; margin-bottom: 4px;">Device</div>
                                                    <div style="color: #111827; font-size: 14px; font-weight: 500;">{{ device.device_name }}</div>
                                                    <div style="color: #6b7280; font-size: 12px; margin-top: 2px;">{{ device.browser }} • {{ device.os }}</div>
                                                </td>
                                            </tr>
                                        </table>
                                    </td>
                                    
                                    <!-- Location -->
                                    <td width="50%" style="padding: 18px 20px; vertical-align: top;">
                                        <table cellpadding="0" cellspacing="0">
                                            <tr>
                                                <td style="vertical-align: top; padding-right: 8px;">
                                                    <!-- Location Icon SVG -->
                                                    <svg width="14" height="14" viewBox="0 0 20 20" fill="none" style="display: block; margin-top: 2px;">
                                                        <path d="M17.5 8.33333C17.5 14.1667 10 19.1667 10 19.1667C10 19.1667 2.5 14.1667 2.5 8.33333C2.5 6.34421 3.29018 4.4366 4.6967 3.03007C6.10322 1.62355 8.01088 0.833328 10 0.833328C11.9891 0.833328 13.8968 1.62355 15.3033 3.03007C16.7098 4.4366 17.5 6.34421 17.5 8.33333Z" stroke="#9ca3af" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                                                        <path d="M10 10.8333C11.3807 10.8333 12.5 9.71405 12.5 8.33333C12.5 6.95262 11.3807 5.83333 10 5.83333C8.61929 5.83333 7.5 6.95262 7.5 8.33333C7.5 9.71405 8.61929 10.8333 10 10.8333Z" stroke="#9ca3af" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                                                    </svg>
                                                </td>
                                                <td style="vertical-align: top;">
                                                    <div style="color: #6b7280; font-size: 11px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; margin-bottom: 4px;">Location</div>
                                                    <div style="color: #111827; font-size: 14px; font-weight: 500;">{% if location %}{{ location }}{% else %}Unknown{% endif %}</div>
                                                    {% if isp %}
                                                    <div style="color: #6b7280; font-size: 12px; margin-top: 2px;">{{ isp }}</div>
                                                    {% endif %}
                                                </td>
                                            </tr>
                                        </table>
                                    </td>
                                </tr>
                                
                            </table>
                            
                            <!-- Security Notice -->
                            {% if alert.type == 'duress' %}
                            <div style="background-color: #fef2f2; border-left: 3px solid #dc2626; padding: 16px 18px; margin-bottom: 24px; border-radius: 4px;">
                                <table cellpadding="0" cellspacing="0">
                                    <tr>
                                        <td style="vertical-align: top; padding-right: 10px;">
                                            <!-- Warning Icon SVG -->
                                            <svg width="18" height="18" viewBox="0 0 20 20" fill="none" style="display: block; margin-top: 1px;">
                                                <path d="M10 18C14.4183 18 18 14.4183 18 10C18 5.58172 14.4183 2 10 2C5.58172 2 2 5.58172 2 10C2 14.4183 5.58172 18 10 18Z" stroke="#dc2626" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                                                <path d="M10 6V10" stroke="#dc2626" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                                                <path d="M10 14H10.01" stroke="#dc2626" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                            </svg>
                                        </td>
                                        <td style="vertical-align: top;">
                                            <div style="color: #991b1b; font-size: 13px; font-weight: 600; margin-bottom: 4px;">Critical Security Alert</div>
                                            <div style="color: #7f1d1d; font-size: 13px; line-height: 1.5;">{{ alert.footer_message }}</div>
                                        </td>
                                    </tr>
                                </table>
                            </div>
                            {% else %}
                            <div style="background-color: #fffbeb; border-left: 3px solid #f59e0b; padding: 16px 18px; margin-bottom: 24px; border-radius: 4px;">
                                <table cellpadding="0" cellspacing="0">
                                    <tr>
                                        <td style="vertical-align: top; padding-right: 10px;">
                                            <!-- Info Icon SVG -->
                                            <svg width="18" height="18" viewBox="0 0 20 20" fill="none" style="display: block; margin-top: 1px;">
                                                <path d="M10 18C14.4183 18 18 14.4183 18 10C18 5.58172 14.4183 2 10 2C5.58172 2 2 5.58172 2 10C2 14.4183 5.58172 18 10 18Z" stroke="#f59e0b" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                                                <path d="M10 14V10" stroke="#f59e0b" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                                                <path d="M10 6H10.01" stroke="#f59e0b" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                            </svg>
                                        </td>
                                        <td style="vertical-align: top;">
                                            <div style="color: #92400e; font-size: 13px; font-weight: 600; margin-bottom: 4px;">Security Reminder</div>
                                            <div style="color: #78350f; font-size: 13px; line-height: 1.5;">{{ alert.footer_message }}</div>
                                        </td>
                                    </tr>
                                </table>
                            </div>
                            {% endif %}
                            
                            <!-- Action Button (if applicable) -->
                            {% if alert.action_text and alert.action_url %}
                            <table cellpadding="0" cellspacing="0" style="margin-bottom: 8px;">
                                <tr>
                                    <td>
                                        <a href="{{ alert.action_url }}" style="display: inline-block; background-color: {{ alert.accent_color }}; color: #ffffff; text-decoration: none; padding: 12px 24px; border-radius: 6px; font-weight: 600; font-size: 14px; border: 1px solid {{ alert.accent_color }};">
                                            {{ alert.action_text }}
                                        </a>
                                    </td>
                                </tr>
                            </table>
                            {% endif %}
                            
                            <!-- Help Text -->
                            <p style="margin: 0; color: #6b7280; font-size: 13px; line-height: 1.6;">
                                If you didn't recognize this activity, 
                                <a href="#" style="color: #2563eb; text-decoration: none; font-weight: 500;">secure your account</a> 
                                or contact support immediately.
                            </p>
                            
                        </td>
                    </tr>
                    
                    <!-- Footer -->
                    <tr>
                        <td style="padding: 24px 32px; background-color: #f9fafb; border-top: 1px solid #e5e7eb; text-align: center;">
                            <p style="margin: 0 0 4px; color: #6b7280; font-size: 12px; line-height: 1.5;">
                                This is an automated security notification from AccountSafe
                            </p>
                            <p style="margin: 0; color: #9ca3af; font-size: 11px;">
                                End-to-end encrypted • Zero-knowledge architecture
                            </p>
                            <p style="margin: 12px 0 0; color: #d1d5db; font-size: 10px;">
                                © 2026 AccountSafe. All rights reserved.
                            </p>
                        </td>
                    </tr>
                    
                </table>
            </td>
        </tr>
    </table>
    
</body>
</html>
